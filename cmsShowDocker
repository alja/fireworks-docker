#!/bin/bash

#!/bin/sh
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 tag" >&2
    echo "Example cmsShowDocker cmsShow-11.2"
    echo "Valid tags: cmsShow-11.2"
  exit 1
fi


# Setting up X11 forwarding which utilizes local wifi
echo "-----------------------"
IP=$(ifconfig en0 | grep inet | awk '$1=="inet" {print $2}')
echo "Your IP is set to:" $IP
/opt/X11/bin/xhost + $IP # For Mac OSX Catalina the XQuartz xhost is not in $PATH so full path is needed

IMAGEVERSION=$1
IMAGE=aljamrak/fireworks:${IMAGEVERSION}

# Building commandline
CMD="docker run \
    -it \
    --rm \
    --name fw${IMAGEVERSION} \
    -e DISPLAY=$IP:0 \
    -e XAUTHORITY=/.Xauthority \
    --net host \
    -v ${HOME}/.Xauthority:/.Xauthority\
    -v ${HOME}:/mnt/myhome"




CMD="${CMD} ${IMAGE}"

# Printing out full docker command used
echo "-----------------------"
echo "Running docker command:"
echo $CMD
echo "-----------------------"
echo "Run Docker Container!"
echo "..."
echo "..."
echo "..."
$CMD
